



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="RXJS文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Observable(观察体) - RXJS文档</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#observable" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="RXJS文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                RXJS文档
              </span>
              <span class="md-header-nav__topic">
                Observable(观察体)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/rxjs-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/rxjs-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="前言" class="md-tabs__link">
        前言
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../ReactiveX/intro/" title="响应式" class="md-tabs__link">
          响应式
        </a>
      
    </li>
  

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../tutorial/basics/" title="教程" class="md-tabs__link">
          教程
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="概念" class="md-tabs__link md-tabs__link--active">
          概念
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../pipeable-operators/" title="高级" class="md-tabs__link">
          高级
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../angular/observables/" title="angular" class="md-tabs__link">
          angular
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    RXJS文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/rxjs-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/rxjs-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      响应式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        响应式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/intro/" title="ReactiveX" class="md-nav__link">
      ReactiveX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Observable/" title="Observable(观察体)" class="md-nav__link">
      Observable(观察体)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Operators/" title="Operators(观察者)" class="md-nav__link">
      Operators(观察者)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Single/" title="Single(单)" class="md-nav__link">
      Single(单)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Subject/" title="Subject(主体)" class="md-nav__link">
      Subject(主体)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Scheduler/" title="Scheduler(调度程序)" class="md-nav__link">
      Scheduler(调度程序)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/tutorials/" title="教程" class="md-nav__link">
      教程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installation/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      教程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        教程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/basics/" title="基础" class="md-nav__link">
      基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/applications/" title="应用" class="md-nav__link">
      应用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Observable(观察体)
      </label>
    
    <a href="./" title="Observable(观察体)" class="md-nav__link md-nav__link--active">
      Observable(观察体)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="拉与推" class="md-nav__link">
    拉与推
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="观察员一般化" class="md-nav__link">
    观察员一般化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observabl" title="一个Observabl的解剖" class="md-nav__link">
    一个Observabl的解剖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" title="创建观察点" class="md-nav__link">
    创建观察点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="订阅观察者" class="md-nav__link">
    订阅观察者
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="执行观察" class="md-nav__link">
    执行观察
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="处理可观察的执行" class="md-nav__link">
    处理可观察的执行
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../observer/" title="Observer(观察者)" class="md-nav__link">
      Observer(观察者)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../subscription/" title="Subscription(订阅)" class="md-nav__link">
      Subscription(订阅)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../operators/" title="Operators(操作符)" class="md-nav__link">
      Operators(操作符)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../subject/" title="Subject(主体)" class="md-nav__link">
      Subject(主体)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scheduler/" title="Scheduler(调度程序)" class="md-nav__link">
      Scheduler(调度程序)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      高级
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        高级
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pipeable-operators/" title="Pipeable 操作符" class="md-nav__link">
      Pipeable 操作符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rxmarbles/" title="弹珠图" class="md-nav__link">
      弹珠图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../marble-testing/" title="编写弹珠测试" class="md-nav__link">
      编写弹珠测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal-marble-tests/" title="大理石测试" class="md-nav__link">
      大理石测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../operator-creation/" title="创建操作符" class="md-nav__link">
      创建操作符
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      angular
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        angular
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../angular/observables/" title="观察体" class="md-nav__link">
      观察体
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../angular/rx-library/" title="RxJS 库" class="md-nav__link">
      RxJS 库
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../angular/observables-in-angular/" title="Angular的观察体" class="md-nav__link">
      Angular的观察体
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../angular/practical-observable-usage/" title="用法实战" class="md-nav__link">
      用法实战
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../angular/comparing-observables/" title="与其它技术的比较" class="md-nav__link">
      与其它技术的比较
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../maintainer-guidelines/" title="维护者指南" class="md-nav__link">
      维护者指南
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../CODE_OF_CONDUCT/" title="行为守则" class="md-nav__link">
      行为守则
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../CONTRIBUTING/" title="感谢" class="md-nav__link">
      感谢
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../other/" title="扩展学习" class="md-nav__link">
      扩展学习
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="拉与推" class="md-nav__link">
    拉与推
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="观察员一般化" class="md-nav__link">
    观察员一般化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observabl" title="一个Observabl的解剖" class="md-nav__link">
    一个Observabl的解剖
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" title="创建观察点" class="md-nav__link">
    创建观察点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" title="订阅观察者" class="md-nav__link">
    订阅观察者
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" title="执行观察" class="md-nav__link">
    执行观察
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" title="处理可观察的执行" class="md-nav__link">
    处理可观察的执行
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="observable">Observable<a class="headerlink" href="#observable" title="Permanent link">&para;</a></h1>
<p>Observable是lazy Push多个值的集合。
他们填补了下表中的遗漏点：</p>
<table>
<thead>
<tr>
<th></th>
<th>单</th>
<th>多</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Pull</strong></td>
<td><a href="https://developer.mozilla.org/en-US/docs/Glossary/Function"><code>Function</code></a></td>
<td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols"><code>Iterator</code></a></td>
</tr>
<tr>
<td><strong>Push</strong></td>
<td><a href="https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Promise"><code>Promise</code></a></td>
<td><a href="../../class/es6/Observable.js~Observable.html"><code>Observable</code></a></td>
</tr>
</tbody>
</table>
<p><strong>例.</strong> 以下是在订阅时立即（同步）推入值<code>1</code>，<code>2</code>，<code>3</code>的Observable, 并且在订阅呼叫之后已过去了一秒钟的值“4”，然后完成:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>调用Observable并查看这些值, 我们需要<em>订阅</em>:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;就在订阅之前&#39;</span><span class="p">);</span>
<span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
  <span class="nx">next</span><span class="o">:</span> <span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got value &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">),</span>
  <span class="nx">error</span><span class="o">:</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;something wrong occurred: &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">),</span>
  <span class="nx">complete</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">),</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;只是订阅后&#39;</span><span class="p">);</span>
</pre></div>

<p>它在控制台上执行:</p>
<div class="codehilite"><pre><span></span>just before subscribe
got value 1
got value 2
got value 3
just after subscribe
got value 4
done
</pre></div>

<h2 id="_1">拉与推<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><em>Pull</em>和<em>Push</em>是两种不同的协议，它们描述数据<em>生产者</em>如何与数据<em>消费者</em>进行通信。</p>
<p><strong>什么是拉?</strong> 在Pull系统中，消费者确定何时从数据生产者接收数据。 生产者本身并不知道数据何时传递给消费者。</p>
<p>每个JavaScript函数都是一个Pull系统。 该函数是数据的生产者，调用函数的代码通过从其调用中"拉出"<em>单个</em>返回值来消耗它。</p>
<p>ES2015引入了<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*">生成器函数和迭代器</a> (<code>function*</code>), 另一种拉式系统。 调用<code>iterator.next()</code>的代码是消费者，从迭代器（生产者）中"拉出"<em>多个</em>值。</p>
<table>
<thead>
<tr>
<th></th>
<th>生产者</th>
<th>消费者</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Pull</strong></td>
<td><strong>Passive:</strong> 在请求时产生数据.</td>
<td><strong>Active:</strong> 决定何时请求数据.</td>
</tr>
<tr>
<td><strong>Push</strong></td>
<td><strong>Active:</strong> 以自己的速度生成数据.</td>
<td><strong>Passive:</strong> 对收到的数据作出反应.</td>
</tr>
</tbody>
</table>
<p><strong>什么是推送？</strong> 在推送系统中，生产者确定何时向消费者发送数据。 消费者不知道它何时会收到该数据。</p>
<p>承诺是当今JavaScript中最常见的一种Push系统。
承诺（生产者）为已注册的回调（消费者）提供已解决的价值，但与函数不同的是，Promise负责精确确定何时该值被“推送”回调。</p>
<p>RxJS推出了一个新的JavaScript推送系统Observables。
一个可观察者是多个价值观的生产者，将他们推给观察者（消费者）。</p>
<ul>
<li><strong>函数</strong>是一个懒惰评估的计算，在调用时同步返回一个值。</li>
<li><strong>生成器</strong>是一种懒惰评估的计算，它在迭代过程中同步地将零（可能）无限大的值返回。</li>
<li><strong>诺言</strong>是一种可能（或可能不）最终返回单个值的计算。</li>
<li><strong>Observable</strong>是一种懒惰评估的计算，它可以同步地或异步地将零从它被调用的时刻（可能）无限值地返回。</li>
</ul>
<h2 id="_2">观察员一般化<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>与流行的说法相反，Observables不像EventEmitters，也不像Promises for multiple values。
在某些情况下，观察对象可能像事件发送者一样行事，即当他们使用RxJS主题进行多播时，但通常它们不像事件发送者那样行事。</p>
<p><span class="informal">Observable就像函数零参数一样，但将它们概括为允许多个值。</span></p>
<p>考虑以下:</p>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">foo</span><span class="p">.</span><span class="nx">call</span><span class="p">();</span> <span class="c1">// same as foo()</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">foo</span><span class="p">.</span><span class="nx">call</span><span class="p">();</span> <span class="c1">// same as foo()</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
</pre></div>

<p>我们期望看到成果:</p>
<div class="codehilite"><pre><span></span>&quot;Hello&quot;
42
&quot;Hello&quot;
42
</pre></div>

<p>你可以在上面写同样的行为，但是使用Observables:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">foo</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p>输出是一样的:</p>
<div class="codehilite"><pre><span></span>&quot;Hello&quot;
42
&quot;Hello&quot;
42
</pre></div>

<p>发生这种情况是因为函数和Observables都是懒计算。 如果你不调用这个函数，<code>console.log（'Hello'）</code>不会发生。 另外对于Observable，如果你不“叫”它（带<code>subscribe</code>），<code>console.log（'Hello'）</code>不会发生。,另外，“调用”或“订阅”是一个孤立的操作：两个函数调用触发两个单独的副作用，两个Observable订阅触发两个单独的副作用。 与EventEmitters不同，它们共享副作用，并且无论订阅者是否存在都有热切的执行，Obserbles没有共享执行并且是懒惰的。</p>
<p>订阅Observable类似于调用Function。</p>
<p>有些人声称Observable是异步的。 那是不正确的。 如果您使用日志环绕函数调用，如下所示：</p>
<!-- skip-example -->

<div class="codehilite"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">foo</span><span class="p">.</span><span class="nx">call</span><span class="p">());</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">);</span>
</pre></div>

<p>你会看到输出：</p>
<div class="codehilite"><pre><span></span>&quot;before&quot;
&quot;Hello&quot;
42
&quot;after&quot;
</pre></div>

<p>这与Observables一样</p>
<!-- skip-example -->

<div class="codehilite"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">);</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">);</span>
</pre></div>

<p>输出是：</p>
<div class="codehilite"><pre><span></span>&quot;before&quot;
&quot;Hello&quot;
42
&quot;after&quot;
</pre></div>

<p>证明<code>foo</code>的订阅是完全同步的，就像一个函数。</p>
<p>Observable能够同步或异步传递值。</p>
<p>Observable和函数之间有什么区别？ <strong>观察对象可以随着时间的推移“返回”多个值</strong>, 某些功能不能. 你不能这样做:</p>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
  <span class="k">return</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// dead code. will never happen</span>
<span class="p">}</span>
</pre></div>

<p>函数只能返回一个值。,然而，可观测物可以做到这一点:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// &quot;return&quot; another value</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span> <span class="c1">// &quot;return&quot; yet another</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">);</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">);</span>
</pre></div>

<p>与同步输出:</p>
<div class="codehilite"><pre><span></span>&quot;before&quot;
&quot;Hello&quot;
42
100
200
&quot;after&quot;
</pre></div>

<p>但你也可以异步“返回”值:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
  <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">300</span><span class="p">);</span> <span class="c1">// happens asynchronously</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">);</span>
<span class="nx">foo</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">);</span>
</pre></div>

<p>With output:</p>
<div class="codehilite"><pre><span></span>&quot;before&quot;
&quot;Hello&quot;
42
100
200
&quot;after&quot;
300
</pre></div>

<p>结论:</p>
<ul>
<li><code>func.call()</code> means "<em>give me one value synchronously</em>"</li>
<li><code>observable.subscribe()</code> means "<em>give me any amount of values, either synchronously or asynchronously</em>"</li>
</ul>
<h2 id="observabl">一个Observabl的解剖<a class="headerlink" href="#observabl" title="Permanent link">&para;</a></h2>
<p>Observables are <strong>created</strong> using <code>Rx.Observable.create</code> or a creation operator, are <strong>subscribed</strong> to with an Observer, <strong>execute</strong> to deliver <code>next</code> / <code>error</code> / <code>complete</code> notifications to the Observer, and their execution may be <strong>disposed</strong>. These four aspects are all encoded in an Observable instance, but some of these aspects are related to other types, like Observer and Subscription.</p>
<p>Core Observable concerns:
- <strong>Creating</strong> Observables
- <strong>Subscribing</strong> to Observables
- <strong>Executing</strong> the Observable
- <strong>Disposing</strong> Observables</p>
<h3 id="_3">创建观察点<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><code>Rx.Observable.create</code> is an alias for the <code>Observable</code> constructor, and it takes one argument: the <code>subscribe</code> function.</p>
<p>The following example creates an Observable to emit the string <code>'hi'</code> every second to an Observer.</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">)</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<p><span class="informal">Observables can be created with <code>create</code>, but usually we use the so-called <a href="../overview.html#creation-operators">creation operators</a>, like <code>of</code>, <code>from</code>, <code>interval</code>, etc.</span></p>
<p>In the example above, the <code>subscribe</code> function is the most important piece to describe the Observable. Let's look at what subscribing means.</p>
<h3 id="_4">订阅观察者<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>The Observable <code>observable</code> in the example can be <em>subscribed</em> to, like this:</p>
<!-- skip-example -->

<div class="codehilite"><pre><span></span><span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
</pre></div>

<p>It is not a coincidence that <code>observable.subscribe</code> and <code>subscribe</code> in <code>Observable.create(function subscribe(observer) {...})</code> have the same name. In the library, they are different, but for practical purposes you can consider them conceptually equal.</p>
<p>This shows how <code>subscribe</code> calls are not shared among multiple Observers of the same Observable. When calling <code>observable.subscribe</code> with an Observer, the function <code>subscribe</code> in <code>Observable.create(function subscribe(observer) {...})</code> is run for that given Observer. Each call to <code>observable.subscribe</code> triggers its own independent setup for that given Observer.</p>
<p><span class="informal">Subscribing to an Observable is like calling a function, providing callbacks where the data will be delivered to.</span></p>
<p>This is drastically different to event handler APIs like <code>addEventListener</code> / <code>removeEventListener</code>. With <code>observable.subscribe</code>, the given Observer is not registered as a listener in the Observable. The Observable does not even maintain a list of attached Observers.</p>
<p>A <code>subscribe</code> call is simply a way to start an "Observable execution" and deliver values or events to an Observer of that execution.</p>
<h3 id="_5">执行观察<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>The code inside <code>Observable.create(function subscribe(observer) {...})</code> represents an "Observable execution", a lazy computation that only happens for each Observer that subscribes. The execution produces multiple values over time, either synchronously or asynchronously.</p>
<p>There are three types of values an Observable Execution can deliver:</p>
<ul>
<li>"Next" notification: sends a value such as a Number, a String, an Object, etc.</li>
<li>"Error" notification: sends a JavaScript Error or exception.</li>
<li>"Complete" notification: does not send a value.</li>
</ul>
<p>Next notifications are the most important and most common type: they represent actual data being delivered to an Observer. Error and Complete notifications may happen only once during the Observable Execution, and there can only be either one of them.</p>
<p>These constraints are expressed best in the so-called <em>Observable Grammar</em> or <em>Contract</em>, written as a regular expression:</p>
<div class="codehilite"><pre><span></span>next*(error|complete)?
</pre></div>

<p><span class="informal">In an Observable Execution, zero to infinite Next notifications may be delivered. If either an Error or Complete notification is delivered, then nothing else can be delivered afterwards.</span></p>
<p>The following is an example of an Observable execution that delivers three Next notifications, then completes:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<p>Observables strictly adhere to the Observable Contract, so the following code would not deliver the Next notification <code>4</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="c1">// Is not delivered because it would violate the contract</span>
<span class="p">});</span>
</pre></div>

<p>It is a good idea to wrap any code in <code>subscribe</code> with <code>try</code>/<code>catch</code> block that will deliver an Error notification if it catches an exception:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span> <span class="c1">// delivers an error if it caught one</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<h3 id="_6">处理可观察的执行<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>Because Observable Executions may be infinite, and it's common for an Observer to want to abort execution in finite time, we need an API for canceling an execution. Since each execution is exclusive to one Observer only, once the Observer is done receiving values, it has to have a way to stop the execution, in order to avoid wasting computation power or memory resources.</p>
<p>When <code>observable.subscribe</code> is called, the Observer gets attached to the newly created Observable execution. This call also returns an object, the <code>Subscription</code>:</p>
<!-- skip-example -->

<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
</pre></div>

<p>The Subscription represents the ongoing execution, and has a minimal API which allows you to cancel that execution. Read more about the <a href="../overview.html#subscription"><code>Subscription</code> type here</a>. With <code>subscription.unsubscribe()</code> you can cancel the ongoing execution:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">from</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]);</span>
<span class="kd">var</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">));</span>
<span class="c1">// Later:</span>
<span class="nx">subscription</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
</pre></div>

<p><span class="informal">When you subscribe, you get back a Subscription, which represents the ongoing execution. Just call <code>unsubscribe()</code> to cancel the execution.</span></p>
<p>Each Observable must define how to dispose resources of that execution when we create the Observable using <code>create()</code>. You can do that by returning a custom <code>unsubscribe</code> function from within <code>function subscribe()</code>.</p>
<p>For instance, this is how we clear an interval execution set with <code>setInterval</code>:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Keep track of the interval resource</span>
  <span class="kd">var</span> <span class="nx">intervalID</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">);</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

  <span class="c1">// Provide a way of canceling and disposing the interval resource</span>
  <span class="k">return</span> <span class="kd">function</span> <span class="nx">unsubscribe</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalID</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">});</span>
</pre></div>

<p>Just like <code>observable.subscribe</code> resembles <code>Observable.create(function subscribe() {...})</code>, the <code>unsubscribe</code> we return from <code>subscribe</code> is conceptually equal to <code>subscription.unsubscribe</code>. In fact, if we remove the ReactiveX types surrounding these concepts, we're left with rather straightforward JavaScript.</p>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">subscribe</span><span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">intervalID</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">);</span>
  <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>

  <span class="k">return</span> <span class="kd">function</span> <span class="nx">unsubscribe</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">intervalID</span><span class="p">);</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">unsubscribe</span> <span class="o">=</span> <span class="nx">subscribe</span><span class="p">({</span><span class="nx">next</span><span class="o">:</span> <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)});</span>

<span class="c1">// Later:</span>
<span class="nx">unsubscribe</span><span class="p">();</span> <span class="c1">// dispose the resources</span>
</pre></div>

<p>The reason why we use Rx types like Observable, Observer, and Subscription is to get safety (such as the Observable Contract) and composability with Operators.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../tutorial/applications/" title="应用" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                应用
              </span>
            </div>
          </a>
        
        
          <a href="../observer/" title="Observer(观察者)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                Observer(观察者)
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>