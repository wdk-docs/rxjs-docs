



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="RXJS文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Scheduler(调度程序) - RXJS文档</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="RXJS文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                RXJS文档
              </span>
              <span class="md-header-nav__topic">
                Scheduler(调度程序)
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/rxjs-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/rxjs-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="前言" class="md-tabs__link">
        前言
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../ReactiveX/intro/" title="响应式" class="md-tabs__link">
          响应式
        </a>
      
    </li>
  

      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../tutorial/basics/" title="教程" class="md-tabs__link">
          教程
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../observable/" title="概念" class="md-tabs__link md-tabs__link--active">
          概念
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../pipeable-operators/" title="高级" class="md-tabs__link">
          高级
        </a>
      
    </li>
  

      
        
      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    RXJS文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/rxjs-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/rxjs-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      响应式
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        响应式
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/intro/" title="ReactiveX" class="md-nav__link">
      ReactiveX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Observable/" title="Observable(观察点)" class="md-nav__link">
      Observable(观察点)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Operators/" title="Operators(观察者)" class="md-nav__link">
      Operators(观察者)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Single/" title="Single(单)" class="md-nav__link">
      Single(单)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Subject/" title="Subject(主体)" class="md-nav__link">
      Subject(主体)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/Scheduler/" title="Scheduler(调度程序)" class="md-nav__link">
      Scheduler(调度程序)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ReactiveX/tutorials/" title="教程" class="md-nav__link">
      教程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../introduction/" title="简介" class="md-nav__link">
      简介
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../installation/" title="安装" class="md-nav__link">
      安装
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      教程
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        教程
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/basics/" title="基础" class="md-nav__link">
      基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorial/applications/" title="应用" class="md-nav__link">
      应用
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../observable/" title="Observable(观察点)" class="md-nav__link">
      Observable(观察点)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../observer/" title="Observer(观察者)" class="md-nav__link">
      Observer(观察者)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../subscription/" title="Subscription(订阅)" class="md-nav__link">
      Subscription(订阅)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../operators/" title="Operators(操作符)" class="md-nav__link">
      Operators(操作符)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../subject/" title="Subject(主体)" class="md-nav__link">
      Subject(主体)
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Scheduler(调度程序)
      </label>
    
    <a href="./" title="Scheduler(调度程序)" class="md-nav__link md-nav__link--active">
      Scheduler(调度程序)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scheduler-types" title="Scheduler Types" class="md-nav__link">
    Scheduler Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-schedulers" title="Using Schedulers" class="md-nav__link">
    Using Schedulers
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      高级
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        高级
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pipeable-operators/" title="Pipeable 操作符" class="md-nav__link">
      Pipeable 操作符
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../marble-testing/" title="编写弹珠测试" class="md-nav__link">
      编写弹珠测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../internal-marble-tests/" title="大理石测试" class="md-nav__link">
      大理石测试
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../operator-creation/" title="创建操作符" class="md-nav__link">
      创建操作符
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rxmarbles/" title="弹珠图" class="md-nav__link">
      弹珠图
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../other/" title="扩展学习" class="md-nav__link">
      扩展学习
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../maintainer-guidelines/" title="维护者指南" class="md-nav__link">
      维护者指南
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../CODE_OF_CONDUCT/" title="行为守则" class="md-nav__link">
      行为守则
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../CONTRIBUTING/" title="特约" class="md-nav__link">
      特约
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scheduler-types" title="Scheduler Types" class="md-nav__link">
    Scheduler Types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-schedulers" title="Using Schedulers" class="md-nav__link">
    Using Schedulers
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">调度<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>What is a Scheduler?</strong> A scheduler controls when a subscription starts and when notifications are delivered. It consists of three components.</p>
<ul>
<li><strong>A Scheduler is a data structure.</strong> It knows how to store and queue tasks based on priority or other criteria.</li>
<li><strong>A Scheduler is an execution context.</strong> It denotes where and when the task is executed (e.g. immediately, or in another callback mechanism such as setTimeout or process.nextTick, or the animation frame).</li>
<li><strong>A Scheduler has a (virtual) clock.</strong> It provides a notion of "time" by a getter method <code>now()</code> on the scheduler. Tasks being scheduled on a particular scheduler will adhere only to the time denoted by that clock.</li>
</ul>
<p><span class="informal">A Scheduler lets you define in what execution context will an Observable deliver notifications to its Observer.</span></p>
<p>In the example below, we take the usual simple Observable that emits values <code>1</code>, <code>2</code>, <code>3</code> synchronously, and use the operator <code>observeOn</code> to specify the <code>async</code> scheduler to use for delivering those values.</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">observer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">observeOn</span><span class="p">(</span><span class="nx">Rx</span><span class="p">.</span><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">async</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;just before subscribe&#39;</span><span class="p">);</span>
<span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">({</span>
  <span class="nx">next</span><span class="o">:</span> <span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got value &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">),</span>
  <span class="nx">error</span><span class="o">:</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;something wrong occurred: &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">),</span>
  <span class="nx">complete</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">),</span>
<span class="p">});</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;just after subscribe&#39;</span><span class="p">);</span>
</pre></div>

<p>Which executes with the output:</p>
<div class="codehilite"><pre><span></span>just before subscribe
just after subscribe
got value 1
got value 2
got value 3
done
</pre></div>

<p>Notice how the notifications <code>got value...</code> were delivered after <code>just after subscribe</code>, which is different to the default behavior we have seen so far. This is because <code>observeOn(Rx.Scheduler.async)</code> introduces a proxy Observer between <code>Observable.create</code> and the final Observer. Let's rename some identifiers to make that distinction obvious in the example code:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">observable</span> <span class="o">=</span> <span class="nx">Rx</span><span class="p">.</span><span class="nx">Observable</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">proxyObserver</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">proxyObserver</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="nx">proxyObserver</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
  <span class="nx">proxyObserver</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
  <span class="nx">proxyObserver</span><span class="p">.</span><span class="nx">complete</span><span class="p">();</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">observeOn</span><span class="p">(</span><span class="nx">Rx</span><span class="p">.</span><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">async</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">finalObserver</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">next</span><span class="o">:</span> <span class="nx">x</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;got value &#39;</span> <span class="o">+</span> <span class="nx">x</span><span class="p">),</span>
  <span class="nx">error</span><span class="o">:</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;something wrong occurred: &#39;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">),</span>
  <span class="nx">complete</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">),</span>
<span class="p">};</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;just before subscribe&#39;</span><span class="p">);</span>
<span class="nx">observable</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">finalObserver</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;just after subscribe&#39;</span><span class="p">);</span>
</pre></div>

<p>The <code>proxyObserver</code> is created in <code>observeOn(Rx.Scheduler.async)</code>, and its <code>next(val)</code> function is approximately the following:</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">proxyObserver</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">next</span><span class="o">:</span> <span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">Rx</span><span class="p">.</span><span class="nx">Scheduler</span><span class="p">.</span><span class="nx">async</span><span class="p">.</span><span class="nx">schedule</span><span class="p">(</span>
      <span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">finalObserver</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">x</span><span class="p">),</span>
      <span class="mi">0</span> <span class="cm">/* delay */</span><span class="p">,</span>
      <span class="nx">val</span> <span class="cm">/* will be the x for the function above */</span>
    <span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>

<p>The <code>async</code> Scheduler operates with a <code>setTimeout</code> or <code>setInterval</code>, even if the given <code>delay</code> was zero. As usual, in JavaScript, <code>setTimeout(fn, 0)</code> is known to run the function <code>fn</code> earliest on the next event loop iteration. This explains why <code>got value 1</code> is delivered to the <code>finalObserver</code> after <code>just after subscribe</code> happened.</p>
<p>The <code>schedule()</code> method of a Scheduler takes a <code>delay</code> argument, which refers to a quantity of time relative to the Scheduler's own internal clock. A Scheduler's clock need not have any relation to the actual wall-clock time. This is how temporal operators like <code>delay</code> operate not on actual time, but on time dictated by the Scheduler's clock. This is specially useful in testing, where a <em>virtual time Scheduler</em> may be used to fake wall-clock time while in reality executing scheduled tasks synchronously.</p>
<h2 id="scheduler-types">Scheduler Types<a class="headerlink" href="#scheduler-types" title="Permanent link">&para;</a></h2>
<p>The <code>async</code> Scheduler is one of the built-in schedulers provided by RxJS. Each of these can be created and returned by using static properties of the <code>Scheduler</code> object.</p>
<table>
<thead>
<tr>
<th>Scheduler</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>null</code></td>
<td>By not passing any scheduler, notifications are delivered synchronously and recursively. Use this for constant-time operations or tail recursive operations.</td>
</tr>
<tr>
<td><code>Rx.Scheduler.queue</code></td>
<td>Schedules on a queue in the current event frame (trampoline scheduler). Use this for iteration operations.</td>
</tr>
<tr>
<td><code>Rx.Scheduler.asap</code></td>
<td>Schedules on the micro task queue, which uses the fastest transport mechanism available, either Node.js' <code>process.nextTick()</code> or Web Worker MessageChannel or setTimeout or others. Use this for asynchronous conversions.</td>
</tr>
<tr>
<td><code>Rx.Scheduler.async</code></td>
<td>Schedules work with <code>setInterval</code>. Use this for time-based operations.</td>
</tr>
</tbody>
</table>
<h2 id="using-schedulers">Using Schedulers<a class="headerlink" href="#using-schedulers" title="Permanent link">&para;</a></h2>
<p>You may have already used schedulers in your RxJS code without explicitly stating the type of schedulers to be used. This is because all Observable operators that deal with concurrency have optional schedulers. If you do not provide the scheduler, RxJS will pick a default scheduler by using the principle of least concurrency. This means that the scheduler which introduces the least amount of concurrency that satisfies the needs of the operator is chosen. For example, for operators returning an observable with a finite and small number of messages, RxJS uses no Scheduler, i.e. <code>null</code> or <code>undefined</code>.  For operators returning a potentially large or infinite number of messages, <code>queue</code> Scheduler is used. For operators which use timers, <code>async</code> is used.</p>
<p>Because RxJS uses the least concurrency scheduler, you can pick a different scheduler if you want to introduce concurrency for performance purpose.  To specify a particular scheduler, you can use those operator methods that take a scheduler, e.g., <code>from([10, 20, 30], Rx.Scheduler.async)</code>.</p>
<p><strong>Static creation operators usually take a Scheduler as argument.</strong> For instance, <code>from(array, scheduler)</code> lets you specify the Scheduler to use when delivering each notification converted from the <code>array</code>. It is usually the last argument to the operator. The following static creation operators take a Scheduler argument:</p>
<ul>
<li><code>bindCallback</code></li>
<li><code>bindNodeCallback</code></li>
<li><code>combineLatest</code></li>
<li><code>concat</code></li>
<li><code>empty</code></li>
<li><code>from</code></li>
<li><code>fromPromise</code></li>
<li><code>interval</code></li>
<li><code>merge</code></li>
<li><code>of</code></li>
<li><code>range</code></li>
<li><code>throw</code></li>
<li><code>timer</code></li>
</ul>
<p><strong>Use <code>subscribeOn</code> to schedule in what context will the <code>subscribe()</code> call happen.</strong> By default, a <code>subscribe()</code> call on an Observable will happen synchronously and immediately. However, you may delay or schedule the actual subscription to happen on a given Scheduler, using the instance operator <code>subscribeOn(scheduler)</code>, where <code>scheduler</code> is an argument you provide.</p>
<p><strong>Use <code>observeOn</code> to schedule in what context will notifications be delivered.</strong> As we saw in the examples above, instance operator <code>observeOn(scheduler)</code> introduces a mediator Observer between the source Observable and the destination Observer, where the mediator schedules calls to the destination Observer using your given <code>scheduler</code>.</p>
<p><strong>Instance operators may take a Scheduler as argument.</strong></p>
<p>Time-related operators like <code>bufferTime</code>, <code>debounceTime</code>, <code>delay</code>, <code>auditTime</code>, <code>sampleTime</code>, <code>throttleTime</code>, <code>timeInterval</code>, <code>timeout</code>, <code>timeoutWith</code>, <code>windowTime</code> all take a Scheduler as the last argument, and otherwise operate by default on the <code>Rx.Scheduler.async</code> Scheduler.</p>
<p>Other instance operators that take a Scheduler as argument: <code>cache</code>, <code>combineLatest</code>, <code>concat</code>, <code>expand</code>, <code>merge</code>, <code>publishReplay</code>, <code>startWith</code>.</p>
<p>Notice that both <code>cache</code> and <code>publishReplay</code> accept a Scheduler because they utilize a ReplaySubject. The constructor of a ReplaySubjects takes an optional Scheduler as the last argument because ReplaySubject may deal with time, which only makes sense in the context of a Scheduler. By default, a ReplaySubject uses the <code>queue</code> Scheduler to provide a clock.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../subject/" title="Subject(主体)" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                Subject(主体)
              </span>
            </div>
          </a>
        
        
          <a href="../pipeable-operators/" title="Pipeable 操作符" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                Pipeable 操作符
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>